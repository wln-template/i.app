<style type="text/css">
    .nav{display:table;width:100%;margin-bottom:6px;}
    .nav > div{display:table-cell;width:20%;}
	.nav-item{display:inline-block;width:150px;font-size:1.4rem;line-height:2rem;text-align:center;border-bottom:0.2rem solid #999999;color:#333333;text-align:center;}
	.nav-item.active{border-bottom-color:#DC341D;background-color: #d0ebf5;}
</style>
<div class="wln">
    <div class="nav">
        <div>用户：@Html.Raw(ViewBag.CurrentUser)</div>
        <div style="width:60%;text-align:center;">
            <a href="rightcontent?userid=@ViewBag.UserId" class="nav-item">内容管理权限</a>
            <a href="rightsystem?userid=@ViewBag.UserId" class="nav-item">系统管理权限</a>
            <a href="rightorgan?userid=@ViewBag.UserId" class="nav-item active">部门及区域权限</a>
        </div>
        <div></div>
    </div>
    <table id="dataTable" class="wln-table">
        <tr>
            <td style="width:38px; text-align:center;" field="RowIndex">序号</td>
            <td style="width:auto; text-align:center;" field="Name">部门及区域</td>
            <td style="width:98px; text-align:center;" function="onViewer">内容查看</td>
            <td style="width:98px; text-align:center;" function="onEditer">内容管理</td>
            @if (ViewBag.RightBizSys){<td style="width:98px; text-align:center;" function="onBizSys">业务系统</td>}            
            <td style="width:98px; text-align:center;" function="onSystem">系统管理</td>
            <td style="width:auto;" function="onAction">操作</td>
        </tr>
    </table>
</div>
<script type="text/javascript">
    sessionStorage.setItem('inline', '<li>系统</li><li>用户管理</li><li>区域管理权限</li>');
    var table = control.datagrid('dataTable', location.pathname + '/pager?userid=@ViewBag.UserId&parent=@ViewBag.Parent', 10);
    table.onViewer = function (e) {
        if (e.Viewer > 0) {
            return '<a onclick="Set(\'Organ_Viewer\',\'' + e.Id + '\')" style="color:#7DB72F">已授权</a>';
        } else {
            return '<a onclick="Set(\'Organ_Viewer\',\'' + e.Id + '\')" style="color:#999999">未授权</a>';
        }
    }
    table.onEditer = function (e) {
        if (e.Editer > 0) {
            return '<a onclick="Set(\'Organ_Editer\',\'' + e.Id + '\')" style="color:#7DB72F">已授权</a>';
        } else {
            return '<a onclick="Set(\'Organ_Editer\',\'' + e.Id + '\')" style="color:#999999">未授权</a>';
        }
    }
    table.onBizSys = function (e) {
        if (e.BizSys > 0) {
            return '<a onclick="Set(\'Organ_BizSys\',\'' + e.Id + '\')" style="color:#7DB72F">已授权</a>';
        } else {
            return '<a onclick="Set(\'Organ_BizSys\',\'' + e.Id + '\')" style="color:#999999">未授权</a>';
        }
    }
    table.onSystem = function (e) {
        if (e.System > 0) {
            return '<a onclick="Set(\'Organ_System\',\'' + e.Id + '\')" style="color:#7DB72F">已授权</a>';
        } else {
            return '<a onclick="Set(\'Organ_System\',\'' + e.Id + '\')" style="color:#999999">未授权</a>';
        }
    }
    table.onAction = function (e) {
        return '<a href="rightorgan?userid=@ViewBag.UserId&parent=' + e.Id + '">下级管理</a>';
    }
    function Set(Code, OrganId) {
        $.getJSON(location.pathname + '/set?userid=@ViewBag.UserId&parent=@ViewBag.Parent&code=' + Code + '&organid=' + OrganId, {}, function (json) {
            if (json.success) {
                table.reload();
            } else {
                control.error(json.message);
            }
        });
    }
</script>